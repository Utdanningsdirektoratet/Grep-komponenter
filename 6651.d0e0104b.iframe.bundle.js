"use strict";(self.webpackChunkgrep_components=self.webpackChunkgrep_components||[]).push([[6651],{"./src/components/ToC/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{l:()=>GrepTableOfContent});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),objectWithoutProperties=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),react=__webpack_require__("./node_modules/react/index.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),objectDestructuringEmpty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty.js"),toConsumableArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),lodash_throttle=__webpack_require__("./node_modules/lodash.throttle/index.js"),lodash_throttle_default=__webpack_require__.n(lodash_throttle),use_content_elements=__webpack_require__("./src/hooks/use-content-elements.tsx"),generateElementId=function generateElementId(element){for(var tmpId=element.innerText.replace(/\s/g,"-").toLowerCase(),id=tmpId,index=1;document.getElementById(id);)id="".concat(tmpId,"-").concat(++index);return id},identifyElement=function identifyElement(identify){return identify=identify||generateElementId,function(element){return!element.id&&(element.id=identify(element)),element.id}};var initial={elements:{},setSelected:function setSelected(){throw Error("not implemented")}},context=react.createContext(initial);context.displayName="Grep.ToC.Context";const ToC_context=context;var chunk_D4RADZKF=__webpack_require__("./node_modules/react-router/dist/development/chunk-D4RADZKF.mjs"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),defaultSelector=(0,toConsumableArray.A)(new Array(9)).map((function(_,i){return"h".concat(i+1,':not([role="presentation"])')})).join(","),GrepTableOfContentProvider=function GrepTableOfContentProvider(_ref){var props=Object.assign({},((0,objectDestructuringEmpty.A)(_ref),_ref)),container=props.container,identifier=props.identifier,onSelected=props.onSelected,classes=props.classes,scrollTarget=props.scrollTarget,children=props.children,_props$offsetTop=props.offsetTop,offsetTop=void 0===_props$offsetTop?-10:_props$offsetTop,_props$identifyElemen=props.identifyElementFn,identifyElementFn=void 0===_props$identifyElemen?identifyElement:_props$identifyElemen,_useState=(0,react.useState)(),_useState2=(0,slicedToArray.A)(_useState,2),selected=_useState2[0],_setSelected=_useState2[1],_useState3=(0,react.useState)(),_useState4=(0,slicedToArray.A)(_useState3,2),initialized=_useState4[0],setInitialized=_useState4[1],hash=(0,chunk_D4RADZKF.zy)().hash,scrollToElement=(0,react.useCallback)((function(element){var target=scrollTarget||window,top=element.getBoundingClientRect().top-element.clientHeight-offsetTop;target.scrollBy({top})}),[scrollTarget,offsetTop]),identify=(0,react.useMemo)((function(){return identifyElementFn(identifier||generateElementId)}),[identifier,identifyElementFn]),elements=(0,use_content_elements.s1)(container,props.selector||defaultSelector,{identify}),setSelected=(0,react.useCallback)(lodash_throttle_default()((function(element,scroll){element&&scroll&&scrollToElement(element),_setSelected(element)}),50,{trailing:!1}),[_setSelected,scrollToElement]),getViewportElement=(0,react.useCallback)((function(){var records=Object.values(elements);if(records.length){var index=records.findIndex((function(e){return e.getBoundingClientRect().bottom>offsetTop}));if(index>0){var rect=records[index].getBoundingClientRect();return records[Math.floor(rect.top-offsetTop)<rect.height+20?index:index-1]}return records[index]}}),[elements,offsetTop]);return(0,react.useEffect)((function(){var target=scrollTarget||window;if(target){var onScroll=lodash_throttle_default()((function(){var element=getViewportElement();setSelected(element)}),50);return target.addEventListener("scroll",onScroll,!1),console.debug("scroll observer attached"),function(){return console.debug("scroll observer detached"),target.removeEventListener("scroll",onScroll)}}}),[scrollTarget,setSelected,offsetTop,getViewportElement]),(0,react.useEffect)((function(){selected&&onSelected&&onSelected(selected)}),[selected,onSelected]),(0,react.useEffect)((function(){hash&&elements[hash]&&(console.debug("anchor change, setting selected element"),setSelected(elements[hash],!0))}),[hash,setSelected]),!initialized&&elements&&elements[hash]&&(console.debug("setting initial selected element"),setSelected(elements[hash],!0),setInitialized(!0)),(0,jsx_runtime.jsx)(ToC_context.Provider,{value:{elements,selected,classes,setSelected},children})};GrepTableOfContentProvider.displayName="Grep.ToC.Provider";const provider=GrepTableOfContentProvider;GrepTableOfContentProvider.__docgenInfo={description:"",methods:[],displayName:"Grep.ToC.Provider"};var clsx=__webpack_require__("./node_modules/clsx/dist/clsx.mjs"),Key_enum=__webpack_require__("./node_modules/ts-keycode-enum/dist/js/Key.enum.js"),Link=__webpack_require__("./node_modules/@mui/material/esm/Link/Link.js"),styling=__webpack_require__("./src/styling/index.ts"),useStyles=(0,styling.n9)()((function(_ref,_ref2){var palette=_ref.palette,lvl=_ref2.lvl,defaultColor=(0,styling.dT)(palette.primary.main,.75),linkcolor="var(--grep-toc-link-color, ".concat(defaultColor,")"),selectedColor="var(--grep-toc-selected-color, ".concat(palette.primary.main,")"),focusBackground="var(--grep-toc-focused-background, ".concat((0,styling.dT)(palette.primary.main,.1),")");return{root:{color:linkcolor},link:{display:"block",textDecoration:"none",padding:"2px 0 2px 5px",minHeight:"1rem",borderLeft:"5px solid transparent",paddingLeft:5*lvl,overflow:"hidden",textOverflow:"ellipsis","&--selected":{color:selectedColor,borderLeft:"5px solid ".concat(selectedColor)},"&:focus":{outline:"none",background:focusBackground}}}})),GrepTableOfContentNavTreeNode=function GrepTableOfContentNavTreeNode(props){var linkRef=(0,react.useRef)(null),node=props.node,style=props.style,renderChilds=props.renderChilds,setSelectedValue=props.setSelectedValue,percentageRendered=props.percentageRendered,lvl=node.lvl,el=node.el,index=node.index,children=node.children,_useContext=(0,react.useContext)(ToC_context),selected=_useContext.selected,setSelected=_useContext.setSelected,classes=_useContext.classes,elements=_useContext.elements,isSelected=el===selected,styles=useStyles({lvl}).classes,className=(0,clsx.A)("grep-toc__nav-tree-node",isSelected&&"grep-toc__nav-tree-node--selected",styles.root,null==classes?void 0:classes.node,props.className),_useState=(0,react.useState)(!1),_useState2=(0,slicedToArray.A)(_useState,2),awaitingRender=_useState2[0],setAwaitingRender=_useState2[1],txt=el.innerText,location=(0,chunk_D4RADZKF.zy)(),url="".concat(location.pathname).concat(location.search,"#").concat(node.id);(0,react.useEffect)((function(){var link=linkRef.current;isSelected?null==link||link.scrollIntoViewIfNeeded():link===document.activeElement&&(null==link||link.blur())}),[isSelected,linkRef,setSelectedValue]);var tabIndex=isSelected?0:-1;(0,react.useEffect)((function(){awaitingRender&&(doSelect(),setAwaitingRender(!1))}),[percentageRendered]);var doSelect=function doSelect(){var checkAwaitRender=arguments.length>0&&void 0!==arguments[0]&&arguments[0];window.history.replaceState({},txt,url),setSelected(el,!0);var values=Object.values(elements),newPercentage=values.findIndex((function(e){return e===el}))/values.length+.1;setSelectedValue(newPercentage),checkAwaitRender&&newPercentage>percentageRendered&&setAwaitingRender(!0)};return(0,jsx_runtime.jsxs)("li",{"data-lvl":lvl,className,style,children:[(0,jsx_runtime.jsx)(Link.A,{ref:linkRef,className:(0,clsx.A)(styles.link,isSelected&&"".concat(styles.link,"--selected")),href:url,tabIndex,onClick:function onClick(event){console.debug("node click",node),event.preventDefault(),event.stopPropagation(),doSelect(!0)},color:"inherit",children:txt}),children&&renderChilds(children)]},index)};GrepTableOfContentNavTreeNode.displayName="Grep.ToC.NavTree.Node";const nav_tree_node=GrepTableOfContentNavTreeNode;GrepTableOfContentNavTreeNode.__docgenInfo={description:"",methods:[],displayName:"Grep.ToC.NavTree.Node",props:{node:{required:!0,tsType:{name:"ContextTreeElement"},description:""},className:{required:!1,tsType:{name:"string"},description:""},style:{required:!1,tsType:{name:"ReactCSSProperties",raw:"React.CSSProperties"},description:""},renderChilds:{required:!0,tsType:{name:"signature",type:"function",raw:"(children: ContextTree) => ReactElement",signature:{arguments:[{type:{name:"Record",elements:[{name:"number"},{name:"ContextTreeElement"}],raw:"Record<number, ContextTreeElement>"},name:"children"}],return:{name:"ReactElement"}}},description:""},setSelectedValue:{required:!0,tsType:{name:"signature",type:"function",raw:"(selected: unknown) => void",signature:{arguments:[{type:{name:"unknown"},name:"selected"}],return:{name:"void"}}},description:""},percentageRendered:{required:!0,tsType:{name:"number"},description:""}}};var nav_tree_style_useStyles=(0,styling.n9)()((function(){return{root:{listStyle:"none",padding:0,"& ul":{fontSize:".9em"}}}})),_NavTree=function NavTree(props){var elements=props.elements,style=props.style,setSelectedValue=props.setSelectedValue,percentageRendered=props.percentageRendered,classes=(0,react.useContext)(ToC_context).classes,styles=nav_tree_style_useStyles().classes,className=(0,clsx.A)("grep-toc__nav-tree",styles.root,null==classes?void 0:classes.tree,props.className);return(0,jsx_runtime.jsx)("ul",{className,style,children:Object.values(elements).map((function(node){return(0,jsx_runtime.jsx)(nav_tree_node,{node,renderChilds:function renderChilds(children){return(0,jsx_runtime.jsx)(_NavTree,{elements:children,setSelectedValue,percentageRendered})},setSelectedValue,percentageRendered},node.index)}))})};_NavTree.displayName="Grep.ToC.NavTree";const nav_tree=_NavTree;_NavTree.__docgenInfo={description:"",methods:[],displayName:"Grep.ToC.NavTree",props:{elements:{required:!0,tsType:{name:"Record",elements:[{name:"number"},{name:"ContextTreeElement"}],raw:"Record<number, ContextTreeElement>"},description:""},className:{required:!1,tsType:{name:"string"},description:""},style:{required:!1,tsType:{name:"ReactCSSProperties",raw:"React.CSSProperties"},description:""},setSelectedValue:{required:!0,tsType:{name:"signature",type:"function",raw:"(selected: unknown) => void",signature:{arguments:[{type:{name:"unknown"},name:"selected"}],return:{name:"void"}}},description:""},percentageRendered:{required:!0,tsType:{name:"number"},description:""}}};var nav_style_useStyles=(0,styling.n9)()((function(){return{root:{fontSize:18,overflowY:"scroll",outline:"none","&::-webkit-scrollbar":{width:0,background:"transparent"}},keyboardHint:{position:"relative","&::after":{content:'"innholdsfortegnelse: [ alt + i ]"',fontSize:12,position:"absolute",display:"block",top:5,right:5,background:(0,styling.dT)("#000",.1),padding:"2px 5px"}}}})),defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),getElementLevel=function getElementLevel(el){var res=el.nodeName.match(/H([1-9])/);if(res){var _res=(0,slicedToArray.A)(res,2),lvl=(_res[0],_res[1]);return Number(lvl)}return 0};var normalize=function normalize(elements){return elements.reduce((function(curr,el,index){var _reverse$find,id=el.id,lvl=getElementLevel(el,elements[index-1]),parent=null===(_reverse$find=(0,toConsumableArray.A)(curr).reverse().find((function(obj){return obj.lvl<lvl})))||void 0===_reverse$find?void 0:_reverse$find.index;return curr.push({id,el,lvl,parent,index}),curr}),[])};var _nest=function nest(items,id){return items.filter((function(item){return item.parent===id})).reduce((function(curr,item){return Object.assign(curr,(0,defineProperty.A)({},item.index,(0,objectSpread2.A)((0,objectSpread2.A)({},item),{},{children:_nest(items,item.index)})))}),{})},buildTree=function buildTree(elements){var items=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:normalize)(elements);return _nest(items)};var GrepTableOfContentNav=function GrepTableOfContentNav(props){var _useState=(0,react.useState)(!1),_useState2=(0,slicedToArray.A)(_useState,2),showKeyboardHint=_useState2[0],setShowKeyboardHint=_useState2[1],ref=(0,react.useRef)(null),_useContext=(0,react.useContext)(ToC_context),elements=_useContext.elements,classes=_useContext.classes,selected=_useContext.selected,setSelected=_useContext.setSelected,tree=(0,react.useMemo)((function(){return buildTree(Object.values(elements))}),[elements]),focusSelected=(0,react.useCallback)((function(){requestAnimationFrame((function(){if(ref.current instanceof HTMLElement){var active=ref.current.querySelector('[tabindex="0"]');active instanceof HTMLElement?active.focus():ref.current.focus()}}))}),[ref]);(0,react.useEffect)((function(){var onKeyDown=function onKeyDown(e){e.keyCode===Key_enum.U.Alt&&setShowKeyboardHint(!0),e.altKey&&e.keyCode===Key_enum.U.I&&focusSelected()},onKeyUp=function onKeyUp(e){e.keyCode===Key_enum.U.Alt&&setShowKeyboardHint(!1)};return window.addEventListener("keydown",onKeyDown),window.addEventListener("keyup",onKeyUp),function(){window.removeEventListener("keydown",onKeyDown),window.removeEventListener("keyup",onKeyUp)}}),[focusSelected]);var style=nav_style_useStyles().classes,className=(0,clsx.A)("grep-toc__nav",style.root,null==classes?void 0:classes.nav,props.className,showKeyboardHint&&style.keyboardHint);return(0,jsx_runtime.jsx)("nav",{className,style:props.style,tabIndex:selected?-1:0,onKeyDown:function onKeyDown(e){if(selected&&e.which===Key_enum.U.Tab&&!1===e.shiftKey){var tabindex=selected.getAttribute("tabindex");selected.setAttribute("tabindex","0"),selected.focus(),requestAnimationFrame((function(){null===tabindex?selected.removeAttribute("tabindex"):selected.setAttribute("tabindex",tabindex)}))}if([Key_enum.U.UpArrow,Key_enum.U.DownArrow].includes(e.which)){e.preventDefault(),e.stopPropagation();var nodes=Object.values(elements),currentIndex=nodes.indexOf(selected),next=nodes[currentIndex+(e.which===Key_enum.U.UpArrow?-1:1)];next&&setSelected(next,!0),focusSelected()}},ref,children:(0,jsx_runtime.jsx)(nav_tree,{elements:tree,setSelectedValue:props.setSelectedValue,percentageRendered:props.percentageRendered})})};GrepTableOfContentNav.displayName="Grep.ToC.Nav";const nav=GrepTableOfContentNav;GrepTableOfContentNav.__docgenInfo={description:"",methods:[],displayName:"Grep.ToC.Nav",props:{className:{required:!1,tsType:{name:"string"},description:""},style:{required:!1,tsType:{name:"ReactCSSProperties",raw:"React.CSSProperties"},description:""},setSelectedValue:{required:!0,tsType:{name:"signature",type:"function",raw:"(selected: unknown) => void",signature:{arguments:[{type:{name:"unknown"},name:"selected"}],return:{name:"void"}}},description:""},percentageRendered:{required:!0,tsType:{name:"number"},description:""}}};var _excluded=["style","className","setSelectedValue","percentageRendered"],GrepTableOfContent=function GrepTableOfContent(_ref){var style=_ref.style,className=_ref.className,setSelectedValue=_ref.setSelectedValue,percentageRendered=_ref.percentageRendered,props=(0,objectWithoutProperties.A)(_ref,_excluded);return(0,jsx_runtime.jsx)(provider,(0,objectSpread2.A)((0,objectSpread2.A)({},props),{},{children:(0,jsx_runtime.jsx)(nav,{className,style,setSelectedValue,percentageRendered})}))};GrepTableOfContent.displayName="Grep.ToC";GrepTableOfContent.__docgenInfo={description:"",methods:[],displayName:"Grep.ToC",props:{style:{required:!1,tsType:{name:"ReactCSSProperties",raw:"React.CSSProperties"},description:""},className:{required:!1,tsType:{name:"string"},description:""},setSelectedValue:{required:!0,tsType:{name:"signature",type:"function",raw:"(selected: unknown) => void",signature:{arguments:[{type:{name:"unknown"},name:"selected"}],return:{name:"void"}}},description:""},percentageRendered:{required:!0,tsType:{name:"number"},description:""}}}},"./src/hooks/use-content-elements.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{s1:()=>useContentElements});var _home_runner_work_Grep_komponenter_Grep_komponenter_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),_home_runner_work_Grep_komponenter_Grep_komponenter_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),defaultOptions={identify:function identify(el){return el.id},config:{attributes:!1,childList:!0,subtree:!0}},useContentElements=function useContentElements(container,selector,options){var _defaultOptions$optio=(0,_home_runner_work_Grep_komponenter_Grep_komponenter_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__.A)((0,_home_runner_work_Grep_komponenter_Grep_komponenter_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_1__.A)({},defaultOptions),options),filter=_defaultOptions$optio.filter,config=_defaultOptions$optio.config,identify=_defaultOptions$optio.identify,_useState=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({}),_useState2=(0,_home_runner_work_Grep_komponenter_Grep_komponenter_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_2__.A)(_useState,2),elements=_useState2[0],setElements=_useState2[1],getElements=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){var all=Array.from(container.querySelectorAll(selector));return(filter?all.filter(filter):all).reduce((function(curr,el){var id=identify(el);if(curr[id])throw Error("duplicate identifiers!");return curr[id]=el,curr}),{})}),[container,selector,identify,filter]);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){if(container){setElements(getElements());var observer=new MutationObserver((function(){setElements(getElements())}));return observer.observe(container,config),console.debug("observing container",container),function(){observer.disconnect(),console.debug("observing disconnected",container)}}}),[container,config,getElements]),elements}}}]);